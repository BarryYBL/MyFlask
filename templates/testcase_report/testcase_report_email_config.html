{% extends 'home.html' %}
{% block title %}配置邮件发送{% endblock %}
{% block content %}
            <div class="panel-body content-agileits" >
                <form action="{{ url_for('testcase_report_blueprint.testcase_report_sendmail',testcase_time_id=testcase_time_id) }}" method="POST" id="email_config_form" data-toggle="validator" class="form-horizontal">
                    {{ macro.form_group(lable_name="subject",blank_name="邮件标题") }}
                    {{ macro.form_group(lable_name="to_user_list",blank_name="接收人",placeholder_name="多个接收人如：1@qq.com,2@qq.com") }}
                    {{ macro.submit(submit_id="email_config") }}
                </form>
            </div>
{% endblock %}
{% block js %}
    <script>
        $(document).ready(function () {
            var validate = function () {
                    $('#email_config_form').validate({
                        rules: {
                            to_user_list: {required: true, remote: '/email_validate/'}
                        },
                        messages: {
                            to_user_list: {required: '不可为空', remote: '邮箱格式不对'}
                        }
                    })
                };
            $('input').bind('input propertychange', function() {
                validate()
                });
            $('#email_config').click(function () {
                $('#email_config_form').validate({
                        rules: {
                            to_user_list: {required: true, remote: '/email_validate/'}
                        },
                        messages: {
                            to_user_list: {required: '不可为空', remote: '邮箱格式不对'}
                        },
                    submitHandler: function (form) {
                        form.submit()
                    }
                    })
            })
});

    </script>
{% endblock %}